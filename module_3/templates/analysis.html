<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>GradCafe Admissions Analysis</title>

    <style>
        body {
            font-family: Georgia, "Times New Roman", serif;
            background-color: #f6f7f9;
            color: #1f2933;
            margin: 40px;
            line-height: 1.6;
        }

        h1 {
            color: #0f172a;
            border-bottom: 3px solid #334155;
            padding-bottom: 10px;
        }

        h2 {
            color: #1e293b;
            margin-top: 40px;
        }

        .analysis-block {
            background: #ffffff;
            border-left: 5px solid #2563eb;
            padding: 18px 22px;
            margin-bottom: 22px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }

        .analysis-block strong {
            color: #0f172a;
        }

        .answer {
            margin-top: 6px;
            font-weight: bold;
            color: #1d4ed8;
        }

        ul {
            margin-top: 8px;
        }

        li {
            margin-left: 20px;
        }

        hr {
            margin: 50px 0;
            border: none;
            border-top: 2px solid #cbd5e1;
        }

        .data-management {
            background: #0f172a;
            color: #e5e7eb;
            padding: 25px;
            border-radius: 6px;
        }

        .data-management h2 {
            color: #e5e7eb;
            margin-top: 0;
        }

        button {
            background-color: #2563eb;
            color: #ffffff;
            border: none;
            padding: 10px 18px;
            font-size: 15px;
            cursor: pointer;
            border-radius: 4px;
            margin-top: 10px;
        }

        button:hover {
            background-color: #1e40af;
        }

        .note {
            font-size: 14px;
            color: #cbd5e1;
            margin-top: 6px;
        }

        .warning {
            color: #fca5a5;
            font-weight: bold;
            margin-top: 12px;
        }

        .flash {
            margin-top: 12px;
            font-weight: bold;
        }
    </style>
</head>
<body>

<h1>GradCafe Admissions Analysis</h1>

<h2>Analysis</h2>

<div class="analysis-block">
    <strong>How many entries do you have in your database who have applied for Fall 2026?</strong>
    <div class="answer">Applicant count: {{ results.q1 }}</div>
</div>

<div class="analysis-block">
    <strong>What percentage of entries are from International students (not American or Other)?</strong>
    <div class="answer">Percent International: {{ results.q2 }}</div>
</div>

<div class="analysis-block">
    <strong>What is the average GPA, GRE, GRE V, GRE AW?</strong>
    <div class="answer">
        GPA: {{ results.q3[0] }},
        GRE: {{ results.q3[1] }},
        GRE V: {{ results.q3[2] }},
        GRE AW: {{ results.q3[3] }}
    </div>
</div>

<div class="analysis-block">
    <strong>What is the average GPA of American students in Fall 2026?</strong>
    <div class="answer">{{ results.q4 }}</div>
</div>

<div class="analysis-block">
    <strong>What percent of entries for Fall 2026 are Acceptances?</strong>
    <div class="answer">{{ results.q5 }}</div>
</div>

<div class="analysis-block">
    <strong>What is the average GPA of accepted applicants for Fall 2026?</strong>
    <div class="answer">{{ results.q6 }}</div>
</div>

<div class="analysis-block">
    <strong>How many applicants applied to JHU for a Masters in Computer Science?</strong>
    <div class="answer">{{ results.q7 }}</div>
</div>

<div class="analysis-block">
    <strong>How many PhD CS acceptances at Georgetown, MIT, Stanford, CMU?</strong>
    <div class="answer">{{ results.q8 }}</div>
</div>

<div class="analysis-block">
    <strong>How does this change using LLM-generated fields?</strong>
    <div class="answer">{{ results.q9 }}</div>
</div>

<div class="analysis-block">
    <strong>
        Extra Question 1: What is the average GPA by degree type (Masters vs PhD)?
    </strong>
    <div class="answer">
        <ul>
            {% for degree, gpa in results.extra_1 %}
                <li>{{ degree if degree else "Unknown" }}: {{ gpa }}</li>
            {% endfor %}
        </ul>
    </div>
</div>

<div class="analysis-block">
    <strong>
        Extra Question 2: What percentage of applicants were accepted overall?
    </strong>
    <div class="answer">
        {{ results.extra_2 }}
    </div>
</div>

<hr>

<div class="data-management">
    <h2>Data Management</h2>

    <form method="POST" action="/pull-data">
        <button type="submit">Pull Data</button>
        <div class="note">
            Pulls any new GradCafe submissions and adds them to the database.
            This process may take several minutes.
        </div>
    </form>

    <form method="POST" action="/update-analysis">
        <button type="submit">Update Analysis</button>
        <div class="note">
            Refreshes the analysis using the most recent data.
            Disabled while data is being pulled.
        </div>
    </form>

    {% if scrape_running %}
        <div class="warning">
            Cannot update analysis while data is being pulled.
        </div>
    {% endif %}

    {% with messages = get_flashed_messages(with_categories=true) %}
      {% for category, message in messages %}
        <div class="flash">{{ message }}</div>
      {% endfor %}
    {% endwith %}
</div>

</body>
</html>
